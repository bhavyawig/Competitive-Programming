#include<bits/stdc++.h>
using namespace std;
int main()
{
    unsigned long long t,i;
    int j,k;
    int count=0,cntx=0,cnto=0;
    cin>>t;
    char a[3][3];
    for(i=0;i<t;i++)
    {
        for(j=0;j<3;j++)
        {
            for(k=0;k<3;k++)
            {
                cin>>a[j][k];
                if(a[j][k]=='_')
                {
                    count++;
                }
                 if(a[j][k]=='X')
                {
                    cntx++;
                }
                 if(a[j][k]=='O')
                {
                    cnto++;
                }
            }
        }
        if(count>=4)
        {
        if((a[0][0]==a[0][1]==a[0][2]=='X' && a[2][0]==a[2][1]==a[2][2]=='O')|| (a[0][0]==a[0][1]==a[0][2]=='X' && a[1][0]==a[1][1]==a[1][2]=='O')|| (a[1][0]==a[1][1]==a[1][2]=='X' && a[2][0]==a[2][1]==a[2][2]=='O')|| (a[1][0]==a[1][1]==a[1][2]=='X' && a[0][0]==a[0][1]==a[0][2]=='O') || (a[2][0]==a[2][1]==a[2][2]=='X' && a[0][0]==a[0][1]==a[0][2]=='O') || (a[2][0]==a[2][1]==a[2][2]=='X' && a[1][0]==a[1][1]==a[1][2]=='O') || (a[0][0]==a[1][0]==a[2][0]=='X' && a[0][1]==a[1][1]==a[2][1]=='O')|| (a[0][0]==a[1][0]==a[2][0]=='X' && a[0][2]==a[1][2]==a[2][2]=='O') || (a[0][1]==a[1][1]==a[2][1]=='X' && a[0][0]==a[1][0]==a[2][0]=='O') || (a[0][1]==a[1][1]==a[2][1]=='X' && a[0][2]==a[1][2]==a[2][2]=='O') || (a[0][2]==a[1][2]==a[2][2]=='X' && a[0][0]==a[1][0]==a[2][0]=='O') || (a[0][2]==a[1][2]==a[2][2]=='X' && a[0][1]==a[1][1]==a[2][1]=='O'))
           {
               cout<<"3";
           }

        else if((a[0][0]==a[1][0]==a[2][0]==('X'||'O')) || (a[0][1]==a[1][1]==a[2][1]==('X'||'O')) || (a[0][2]==a[1][2]==a[2][2]==('X'||'O')) || (a[0][0]==a[0][1]==a[0][2]==('X'||'O')) || (a[1][0]==a[1][1]==a[1][2]==('X'||'O')) || (a[2][0]==a[2][1]==a[2][2]==('X'||'O')) || (a[0][0]==a[1][1]==a[2][2]==('X'||'O')) || (a[0][2]==a[1][1]==a[2][0]==('X'||'O')) )
        {
            cout<<"1";
        }
        else
        {
            cout<<"2";
        }
        }


        else if(count==3)
        {
            if((a[0][0]==a[0][1]==a[0][2]=='X' && a[2][0]==a[2][1]==a[2][2]=='O')|| (a[0][0]==a[0][1]==a[0][2]=='X' && a[1][0]==a[1][1]==a[1][2]=='O')|| (a[1][0]==a[1][1]==a[1][2]=='X' && a[2][0]==a[2][1]==a[2][2]=='O')|| (a[1][0]==a[1][1]==a[1][2]=='X' && a[0][0]==a[0][1]==a[0][2]=='O') || (a[2][0]==a[2][1]==a[2][2]=='X' && a[0][0]==a[0][1]==a[0][2]=='O') || (a[2][0]==a[2][1]==a[2][2]=='X' && a[1][0]==a[1][1]==a[1][2]=='O') || (a[0][0]==a[1][0]==a[2][0]=='X' && a[0][1]==a[1][1]==a[2][1]=='O')|| (a[0][0]==a[1][0]==a[2][0]=='X' && a[0][2]==a[1][2]==a[2][2]=='O') || (a[0][1]==a[1][1]==a[2][1]=='X' && a[0][0]==a[1][0]==a[2][0]=='O') || (a[0][1]==a[1][1]==a[2][1]=='X' && a[0][2]==a[1][2]==a[2][2]=='O') || (a[0][2]==a[1][2]==a[2][2]=='X' && a[0][0]==a[1][0]==a[2][0]=='O') || (a[0][2]==a[1][2]==a[2][2]=='X' && a[0][1]==a[1][1]==a[2][1]=='O'))
           {
               cout<<"3";
               ans++;
           }
            else if((a[0][0]==a[1][0]==a[2][0]==('X'||'O')) || (a[0][1]==a[1][1]==a[2][1]==('X'||'O')) || (a[0][2]==a[1][2]==a[2][2]==('X'||'O')) || (a[0][0]==a[0][1]==a[0][2]==('X'||'O')) || (a[1][0]==a[1][1]==a[1][2]==('X'||'O')) || (a[2][0]==a[2][1]==a[2][2]==('X'||'O')) || (a[0][0]==a[1][1]==a[2][2]==('X'||'O')) || (a[0][2]==a[1][1]==a[2][0]==('X'||'O')) )
        {
            cout<<"1";
            ans++;
        }
        else
        {
          for(j=0;j<3;j++)
        {
            for(k=0;k<3;k++)
            {
                if(a[j][k]='_')
                {
                    a[j][k]='X';
                    if((a[0][0]==a[1][0]==a[2][0]==('X'||'O')) || (a[0][1]==a[1][1]==a[2][1]==('X'||'O')) || (a[0][2]==a[1][2]==a[2][2]==('X'||'O')) || (a[0][0]==a[0][1]==a[0][2]==('X'||'O')) || (a[1][0]==a[1][1]==a[1][2]==('X'||'O')) || (a[2][0]==a[2][1]==a[2][2]==('X'||'O')) || (a[0][0]==a[1][1]==a[2][2]==('X'||'O')) || (a[0][2]==a[1][1]==a[2][0]==('X'||'O')) )
                    {
                             cout<<"1";
                              ans++;
                    }
                }
            }
        }
        if(ans==0)
        {
            cout<<"2";

        }
        ans=0;
        }

        }


        else if(count==0)
        {
             if((a[0][0]==a[0][1]==a[0][2]=='X' && a[2][0]==a[2][1]==a[2][2]=='O')|| (a[0][0]==a[0][1]==a[0][2]=='X' && a[1][0]==a[1][1]==a[1][2]=='O')|| (a[1][0]==a[1][1]==a[1][2]=='X' && a[2][0]==a[2][1]==a[2][2]=='O')|| (a[1][0]==a[1][1]==a[1][2]=='X' && a[0][0]==a[0][1]==a[0][2]=='O') || (a[2][0]==a[2][1]==a[2][2]=='X' && a[0][0]==a[0][1]==a[0][2]=='O') || (a[2][0]==a[2][1]==a[2][2]=='X' && a[1][0]==a[1][1]==a[1][2]=='O') || (a[0][0]==a[1][0]==a[2][0]=='X' && a[0][1]==a[1][1]==a[2][1]=='O')|| (a[0][0]==a[1][0]==a[2][0]=='X' && a[0][2]==a[1][2]==a[2][2]=='O') || (a[0][1]==a[1][1]==a[2][1]=='X' && a[0][0]==a[1][0]==a[2][0]=='O') || (a[0][1]==a[1][1]==a[2][1]=='X' && a[0][2]==a[1][2]==a[2][2]=='O') || (a[0][2]==a[1][2]==a[2][2]=='X' && a[0][0]==a[1][0]==a[2][0]=='O') || (a[0][2]==a[1][2]==a[2][2]=='X' && a[0][1]==a[1][1]==a[2][1]=='O'))
           {
               cout<<"3";
           }
            else if((a[0][0]==a[1][0]==a[2][0]==('X'||'O')) || (a[0][1]==a[1][1]==a[2][1]==('X'||'O')) || (a[0][2]==a[1][2]==a[2][2]==('X'||'O')) || (a[0][0]==a[0][1]==a[0][2]==('X'||'O')) || (a[1][0]==a[1][1]==a[1][2]==('X'||'O')) || (a[2][0]==a[2][1]==a[2][2]==('X'||'O')) || (a[0][0]==a[1][1]==a[2][2]==('X'||'O')) || (a[0][2]==a[1][1]==a[2][0]==('X'||'O')) )
            {
            cout<<"1";
            }
            else if(cnto>=cntx || cntx>=cnto)
            {
                cout<<"2";
            }
            else
            {
                cout<<"3";
            }


        }
        else if(count==1)
        {
              if((a[0][0]==a[0][1]==a[0][2]=='X' && a[2][0]==a[2][1]==a[2][2]=='O')|| (a[0][0]==a[0][1]==a[0][2]=='X' && a[1][0]==a[1][1]==a[1][2]=='O')|| (a[1][0]==a[1][1]==a[1][2]=='X' && a[2][0]==a[2][1]==a[2][2]=='O')|| (a[1][0]==a[1][1]==a[1][2]=='X' && a[0][0]==a[0][1]==a[0][2]=='O') || (a[2][0]==a[2][1]==a[2][2]=='X' && a[0][0]==a[0][1]==a[0][2]=='O') || (a[2][0]==a[2][1]==a[2][2]=='X' && a[1][0]==a[1][1]==a[1][2]=='O') || (a[0][0]==a[1][0]==a[2][0]=='X' && a[0][1]==a[1][1]==a[2][1]=='O')|| (a[0][0]==a[1][0]==a[2][0]=='X' && a[0][2]==a[1][2]==a[2][2]=='O') || (a[0][1]==a[1][1]==a[2][1]=='X' && a[0][0]==a[1][0]==a[2][0]=='O') || (a[0][1]==a[1][1]==a[2][1]=='X' && a[0][2]==a[1][2]==a[2][2]=='O') || (a[0][2]==a[1][2]==a[2][2]=='X' && a[0][0]==a[1][0]==a[2][0]=='O') || (a[0][2]==a[1][2]==a[2][2]=='X' && a[0][1]==a[1][1]==a[2][1]=='O'))
           {
               cout<<"3";
           }
            else if((a[0][0]==a[1][0]==a[2][0]==('X'||'O')) || (a[0][1]==a[1][1]==a[2][1]==('X'||'O')) || (a[0][2]==a[1][2]==a[2][2]==('X'||'O')) || (a[0][0]==a[0][1]==a[0][2]==('X'||'O')) || (a[1][0]==a[1][1]==a[1][2]==('X'||'O')) || (a[2][0]==a[2][1]==a[2][2]==('X'||'O')) || (a[0][0]==a[1][1]==a[2][2]==('X'||'O')) || (a[0][2]==a[1][1]==a[2][0]==('X' ||'O')) )
            {
            cout<<"1";
            }

            else
            {
             for(j=0;j<3;j++)
             {
            for(k=0;k<3;k++)
            {
                if(a[j][k]='_')
                {
                    a[j][k]='X';
                    if((a[0][0]==a[1][0]==a[2][0]==('X'||'O')) || (a[0][1]==a[1][1]==a[2][1]==('X'||'O')) || (a[0][2]==a[1][2]==a[2][2]==('X'||'O')) || (a[0][0]==a[0][1]==a[0][2]==('X'||'O')) || (a[1][0]==a[1][1]==a[1][2]==('X'||'O')) || (a[2][0]==a[2][1]==a[2][2]==('X'||'O')) || (a[0][0]==a[1][1]==a[2][2]==('X'||'O')) || (a[0][2]==a[1][1]==a[2][0]==('X'||'O')) )
                    {
                             cout<<"1";
                             ans++;
                    }

                }
            }
             }
             if(ans==0)
             {
                 cout<<"2";
             }
ans=0;
        }

        }



        else if(count==2)
        {
             if((a[0][0]==a[0][1]==a[0][2]=='X' && a[2][0]==a[2][1]==a[2][2]=='O')|| (a[0][0]==a[0][1]==a[0][2]=='X' && a[1][0]==a[1][1]==a[1][2]=='O')|| (a[1][0]==a[1][1]==a[1][2]=='X' && a[2][0]==a[2][1]==a[2][2]=='O')|| (a[1][0]==a[1][1]==a[1][2]=='X' && a[0][0]==a[0][1]==a[0][2]=='O') || (a[2][0]==a[2][1]==a[2][2]=='X' && a[0][0]==a[0][1]==a[0][2]=='O') || (a[2][0]==a[2][1]==a[2][2]=='X' && a[1][0]==a[1][1]==a[1][2]=='O') || (a[0][0]==a[1][0]==a[2][0]=='X' && a[0][1]==a[1][1]==a[2][1]=='O')|| (a[0][0]==a[1][0]==a[2][0]=='X' && a[0][2]==a[1][2]==a[2][2]=='O') || (a[0][1]==a[1][1]==a[2][1]=='X' && a[0][0]==a[1][0]==a[2][0]=='O') || (a[0][1]==a[1][1]==a[2][1]=='X' && a[0][2]==a[1][2]==a[2][2]=='O') || (a[0][2]==a[1][2]==a[2][2]=='X' && a[0][0]==a[1][0]==a[2][0]=='O') || (a[0][2]==a[1][2]==a[2][2]=='X' && a[0][1]==a[1][1]==a[2][1]=='O'))
           {
               cout<<"3";
           }

        else if((a[0][0]==a[1][0]==a[2][0]==('X'||'O')) || (a[0][1]==a[1][1]==a[2][1]==('X'||'O')) || (a[0][2]==a[1][2]==a[2][2]==('X'||'O')) || (a[0][0]==a[0][1]==a[0][2]==('X'||'O')) || (a[1][0]==a[1][1]==a[1][2]==('X'||'O')) || (a[2][0]==a[2][1]==a[2][2]==('X'||'O')) || (a[0][0]==a[1][1]==a[2][2]==('X'||'O')) || (a[0][2]==a[1][1]==a[2][0]==('X'||'O')) )
        {
            cout<<"1";
        }
        else
        {
            for(j=0;j<3;j++)
        {
            for(k=0;k<3;k++)
            {
                if(a[j][k]='_')
                {
                    a[j][k]='O';
                    if((a[0][0]==a[1][0]==a[2][0]==('X'||'O')) || (a[0][1]==a[1][1]==a[2][1]==('X'||'O')) || (a[0][2]==a[1][2]==a[2][2]==('X'||'O')) || (a[0][0]==a[0][1]==a[0][2]==('X'||'O')) || (a[1][0]==a[1][1]==a[1][2]==('X'||'O')) || (a[2][0]==a[2][1]==a[2][2]==('X'||'O')) || (a[0][0]==a[1][1]==a[2][2]==('X'||'O')) || (a[0][2]==a[1][1]==a[2][0]==('X'||'O')) )
                    {
                             cout<<"1";
                              ans++;
                    }
                }
            }
        }
        if(ans==0)
        {
            cout<<"2";

        }
        ans=0;
        }

        }
    }
    return 0;
}
